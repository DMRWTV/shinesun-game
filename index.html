<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ShineSun - Global & Referral</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { 
            --sun-gradient: linear-gradient(180deg, #FFD700 0%, #FF8C00 100%); 
            --bg-color: #0b0b0b;
            --card-bg: #1c1c1e;
            --text-gold: #FFD700;
        }

        body { 
            background-color: var(--bg-color); color: white; 
            font-family: 'Inter', sans-serif; margin: 0; padding: 0; 
            user-select: none; overflow: hidden;
        }

        .app-container { display: flex; flex-direction: column; height: 100vh; padding: 20px; box-sizing: border-box; }

        .lang-select {
            position: fixed; top: 15px; right: 15px;
            background: #222; color: white; border: 1px solid var(--text-gold);
            border-radius: 8px; font-size: 12px; padding: 5px; z-index: 3000;
        }

        .header-info { text-align: center; margin-top: 25px; }
        .combo-container { display: flex; justify-content: center; gap: 8px; margin: 10px 0; }
        .combo-slot {
            width: 45px; height: 45px; background: #222; border: 2px dashed #444;
            border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 18px;
        }
        .combo-slot.active { border-color: var(--text-gold); background: var(--card-bg); border-style: solid; }

        .main-score { font-size: 42px; font-weight: 900; text-align: center; margin: 5px 0; }

        .game-area { flex-grow: 1; display: flex; justify-content: center; align-items: center; position: relative; }
        .sun-main {
            width: 180px; height: 180px; background: var(--sun-gradient);
            border-radius: 50%; box-shadow: 0 0 50px rgba(255, 140, 0, 0.4);
            cursor: pointer; transition: transform 0.05s; border: 8px solid rgba(255,255,255,0.1);
        }
        .sun-main:active { transform: scale(0.92); }

        .footer-nav {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: #151515; border-top: 1px solid #333;
            display: flex; justify-content: space-around; padding: 12px 0; z-index: 1000;
        }
        .nav-btn { color: #666; font-size: 9px; text-align: center; cursor: pointer; flex: 1; }
        .nav-btn.active { color: var(--text-gold); font-weight: bold; }

        .view-panel {
            position: fixed; top: 0; left: 0; width: 100%; height: 90vh;
            background: var(--bg-color); z-index: 500; display: none; padding: 20px; 
            box-sizing: border-box; overflow-y: auto; padding-bottom: 100px;
        }
        .card-item {
            background: var(--card-bg); padding: 15px; border-radius: 16px; 
            margin-bottom: 12px; border: 1px solid #2c2c2e;
        }
        .card-row { display: flex; justify-content: space-between; align-items: center; width: 100%; }
        .btn-action { background: var(--text-gold); border: none; padding: 8px 12px; border-radius: 8px; font-weight: bold; color: black; cursor: pointer; }
        
        .plus-one { position: absolute; color: white; font-weight: 800; font-size: 26px; animation: fly 0.7s forwards; pointer-events: none; }
        @keyframes fly { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-120px); } }

        .ref-box { background: #000; padding: 15px; border-radius: 12px; border: 1px dashed var(--text-gold); text-align: center; margin-top: 20px; }
    </style>
</head>
<body>

<select class="lang-select" id="lang-picker" onchange="changeLanguage(this.value)">
    <option value="en">English üá∫üá∏</option>
    <option value="fr">Fran√ßais üá´üá∑</option>
    <option value="es">Espa√±ol üá™üá∏</option>
    <option value="tr">T√ºrk√ße üáπüá∑</option>
</select>

<div class="app-container" id="game-view">
    <div class="header-info">
        <div id="txt-combo-desc" style="font-size: 10px; color: #888;">DAILY COMBO (+5,000,000)</div>
        <div class="combo-container">
            <div class="combo-slot" id="slot-0">?</div>
            <div class="combo-slot" id="slot-1">?</div>
            <div class="combo-slot" id="slot-2">?</div>
        </div>
    </div>
    <div class="main-score" id="score-display">0</div>
    <div class="game-area"><div class="sun-main" id="sun-btn"></div></div>
    <div style="margin-bottom: 70px;">
        <div style="display: flex; justify-content: space-between; font-size: 12px;"><span id="txt-energy">‚ö° Energy</span><span id="energy-val">1000/1000</span></div>
        <div style="width: 100%; height: 8px; background: #333; border-radius: 10px; margin-top: 5px;"><div id="energy-bar" style="width: 100%; height: 100%; background: var(--sun-gradient); border-radius: 10px;"></div></div>
    </div>
</div>

<div id="mission-panel" class="view-panel">
    <h2 id="txt-miss-title" style="color: var(--text-gold);">Missions</h2>
    <div class="card-item"><div class="card-row"><div><b>X (Twitter)</b><br><small>+3,000</small></div><button class="btn-action" onclick="window.open('https://x.com')">GO</button></div></div>
    <div class="card-item"><div class="card-row"><div><b id="txt-ig-story">Instagram Story</b><br><small>+20,000</small></div><button class="btn-action" onclick="alert('Shared!')">SHARE</button></div></div>
    <div class="card-item"><div class="card-row"><div><b>Telegram</b><br><small>+5,000</small></div><button class="btn-action" onclick="window.open('https://t.me')">JOIN</button></div></div>
</div>

<div id="boost-panel" class="view-panel">
    <h2 id="txt-boost-title" style="color: var(--text-gold);">Boosts</h2>
    <div class="card-item" onclick="tryCombo('‚òÄÔ∏è')"><div class="card-row"><div><b id="txt-b1">Solar Panel</b><br><small id="txt-b1-desc">+10/h | 1,000</small></div><button class="btn-action" id="btn-buy-1" onclick="buy(1000, 10)">BUY</button></div></div>
    <div class="card-item" onclick="tryCombo('üöÄ')"><div class="card-row"><div><b id="txt-b2">Rocket</b><br><small id="txt-b2-desc">+50/h | 5,000</small></div><button class="btn-action" id="btn-buy-2" onclick="buy(5000, 50)">BUY</button></div></div>
    <div class="card-item" onclick="tryCombo('üíé')"><div class="card-row"><div><b id="txt-b3">Crystal</b><br><small id="txt-b3-desc">+100/h | 10,000</small></div><button class="btn-action" id="btn-buy-3" onclick="buy(10000, 100)">BUY</button></div></div>
    <div class="card-item" onclick="tryCombo('üî•')"><div class="card-row"><div><b id="txt-b4">Nuclear</b><br><small id="txt-b4-desc">+500/h | 50,000</small></div><button class="btn-action" id="btn-buy-4" onclick="buy(50000, 500)">BUY</button></div></div>
</div>

<div id="ref-panel" class="view-panel">
    <h2 id="txt-ref-title" style="color: var(--text-gold);">Invite Friends</h2>
    <p id="txt-ref-sub" style="font-size: 12px; color: #888;">Earn 50,000 $SHINE for every friend!</p>
    <div class="ref-box">
        <div id="txt-your-link" style="font-size: 10px; color: var(--text-gold); margin-bottom: 10px;">YOUR REFERRAL LINK:</div>
        <code id="ref-link" style="font-size: 11px; word-break: break-all;">https://t.me/YOUR_BOT?start=user123</code>
        <br><br>
        <button class="btn-action" id="btn-copy" onclick="copyLink()">COPY LINK</button>
    </div>
    <div style="margin-top: 30px; text-align: center;">
        <span id="txt-total-ref">Total Friends: 0</span>
    </div>
</div>

<div class="footer-nav">
    <div class="nav-btn active" id="nav-btn-home" onclick="showView('game')">üè†<br><span id="txt-home">Home</span></div>
    <div class="nav-btn" id="nav-btn-miss" onclick="showView('mission')">üöÄ<br><span id="txt-miss">Missions</span></div>
    <div class="nav-btn" id="nav-btn-boost" onclick="showView('boost')">üí∞<br><span id="txt-boost">Boosts</span></div>
    <div class="nav-btn" id="nav-btn-ref" onclick="showView('ref')">üë•<br><span id="txt-ref">Friends</span></div>
</div>

<script>
    const i18n = {
        en: { combo: "DAILY COMBO (+5M)", energy: "‚ö° Energy", home: "Home", miss: "Missions", boost: "Boosts", ref: "Friends", refT: "Invite Friends", refS: "Earn 50,000 $SHINE for every friend!", copy: "COPY LINK", buy: "BUY", b1: "Solar Panel", b2: "Rocket", b3: "Crystal", b4: "Nuclear" },
        fr: { combo: "COMBO QUOTIDIEN (+5M)", energy: "‚ö° √ânergie", home: "Accueil", miss: "Missions", boost: "Boosts", ref: "Amis", refT: "Inviter des Amis", refS: "Gagnez 50,000 $SHINE par ami !", copy: "COPIER LIEN", buy: "ACHETER", b1: "Panneau Solaire", b2: "Fus√©e Shine", b3: "Cristal de Feu", b4: "Fusion Nucl√©aire" },
        es: { combo: "COMBO DIARIO (+5M)", energy: "‚ö° Energ√≠a", home: "Inicio", miss: "Misiones", boost: "Mejoras", ref: "Amigos", refT: "Invitar Amigos", refS: "¬°Gana 50,000 $SHINE por amigo!", copy: "COPIAR", buy: "COMPRAR", b1: "Panel Solar", b2: "Cohete", b3: "Cristal", b4: "Nuclear" },
        tr: { combo: "G√úNL√úK KOMBO (+5M)", energy: "‚ö° Enerji", home: "Ana Sayfa", miss: "G√∂revler", boost: "G√º√ßler", ref: "Arkada≈ülar", refT: "Arkada≈ü Davet Et", refS: "Her arkada≈ü i√ßin 50,000 $SHINE kazan!", copy: "KOPYALA", buy: "SATIN AL", b1: "G√ºne≈ü Paneli", b2: "Roket", b3: "Kristal", b4: "N√ºkleer" }
    };

    function changeLanguage(l) {
        const d = i18n[l];
        document.getElementById('txt-combo-desc').innerText = d.combo;
        document.getElementById('txt-energy').innerText = d.energy;
        document.getElementById('txt-home').innerText = d.home;
        document.getElementById('txt-miss').innerText = d.miss;
        document.getElementById('txt-boost').innerText = d.boost;
        document.getElementById('txt-ref').innerText = d.ref;
        document.getElementById('txt-ref-title').innerText = d.refT;
        document.getElementById('txt-ref-sub').innerText = d.refS;
        document.getElementById('btn-copy').innerText = d.copy;
        document.getElementById('txt-b1').innerText = d.b1;
        document.getElementById('txt-b2').innerText = d.b2;
        document.getElementById('txt-b3').innerText = d.b3;
        document.getElementById('txt-b4').innerText = d.b4;
    }

    let score = parseInt(localStorage.getItem('sh_score')) || 0;
    let energy = 1000;
    let currentCombo = [];
    const target = ['‚òÄÔ∏è', 'üíé', 'üî•'];

    function updateUI() {
        document.getElementById('score-display').innerText = Math.floor(score).toLocaleString();
        document.getElementById('energy-val').innerText = energy + "/1000";
        document.getElementById('energy-bar').style.width = (energy/10) + "%";
    }

    document.getElementById('sun-btn').addEventListener('click', (e) => {
        if(energy > 0) {
            score++; energy--;
            const d = document.createElement('div'); d.className='plus-one'; d.style.left=e.clientX+'px'; d.style.top=e.clientY+'px'; d.innerText="+1"; document.body.appendChild(d);
            setTimeout(()=>d.remove(), 700); updateUI(); save();
        }
    });

    function showView(v) {
        document.querySelectorAll('.view-panel').forEach(p => p.style.display = 'none');
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        if(v !== 'game') {
            document.getElementById(v + '-panel').style.display = 'block';
            document.getElementById('nav-btn-' + v).classList.add('active');
        } else {
            document.getElementById('nav-btn-home').classList.add('active');
        }
    }

    function buy(cost, pow) { if(score >= cost) { score -= cost; updateUI(); save(); alert("Success!"); } }

    function copyLink() {
        const link = document.getElementById('ref-link').innerText;
        navigator.clipboard.writeText(link);
        alert("Link copied to clipboard!");
    }

    function tryCombo(s) {
        if(currentCombo.length < 3) {
            currentCombo.push(s);
            document.getElementById(`slot-${currentCombo.length-1}`).innerText = s;
            document.getElementById(`slot-${currentCombo.length-1}`).classList.add('active');
            if(currentCombo.length === 3) {
                if(JSON.stringify(currentCombo) === JSON.stringify(target)) { score += 5000000; alert("COMBO!"); }
                else { alert("Fail"); currentCombo = []; setTimeout(()=> { for(let i=0;i<3;i++){document.getElementById(`slot-${i}`).innerText="?";document.getElementById(`slot-${i}`).classList.remove('active');}}, 500); }
                updateUI(); save();
            }
        }
    }

    setInterval(() => { if(energy < 1000) energy++; updateUI(); }, 1500);
    function save() { localStorage.setItem('sh_score', score); }

    window.onload = () => {
        // D√©tecter l'ID utilisateur Telegram si possible
        const user = window.Telegram.WebApp.initDataUnsafe.user;
        if(user) {
            document.getElementById('ref-link').innerText = `https://t.me/ShineSun_bot?start=${user.id}`;
        }
        changeLanguage('en');
        updateUI();
    };
</script>
</body>
</html>
